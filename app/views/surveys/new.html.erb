<style>
  /* --- Base Styles --- */
  body {
    font-family: 'Arial', sans-serif;
    background-color: #F8F8F8; /* Light gray background */
    margin: 0;
    padding: 20px;
    display: flex;
    justify-content: center;
    align-items: flex-start; /* Align content to the top of the viewport */
    min-height: 100vh; /* Full viewport height */
    box-sizing: border-box; /* Include padding in element's total width and height */
  }

  /* --- Main Survey Container --- */
  .survey-container {
    background-color: #FFFFFF; /* White card background */
    padding: 40px;
    border-radius: 8px; /* Slightly rounded corners */
    box-shadow: 0 4px 15px rgba(0,0,0,0.1); /* Soft shadow for depth */
    max-width: 700px; /* Maximum width for the survey form */
    width: 100%; /* Ensure it's responsive */
    box-sizing: border-box;
  }

  h3 {
    color: #0056b3; /* Primary blue for headings */
    font-size: 24px;
    margin-bottom: 15px;
    text-align: center;
  }

  p {
    color: #333333; /* Dark gray for general text */
    font-size: 16px;
    line-height: 1.6; /* Improved readability */
    text-align: center;
    margin-bottom: 30px;
  }

  /* --- Rating Buttons Section --- */
  .rating-buttons-wrapper {
    margin-bottom: 25px; /* Space between rating section and observation field */
  }

  .rating-buttons-container {
    display: flex; /* Use Flexbox for horizontal alignment */
    flex-wrap: wrap; /* Allow buttons to wrap to the next line on smaller screens */
    justify-content: center; /* Center the buttons horizontally */
    gap: 8px; /* Space between individual buttons */
    margin-bottom: 5px; /* Space between the number buttons and the "Ruim/Excelente" labels */
  }

  .rating-buttons-item {
    /* Each radio button and its label are grouped here. No direct styles needed for this div. */
  }

  .rating-buttons-item input[type="radio"] {
    /* Hide the default browser radio button visually, but keep it accessible */
    position: absolute;
    opacity: 0;
    width: 0;
    height: 0;
    pointer-events: none; /* Ensure it doesn't interfere with mouse events */
  }

  .rating-buttons-item label { /* Styles for the clickable number labels */
    background-color: #28a745; /* Primary green for buttons */
    color: #ffffff;
    text-decoration: none;
    padding: 12px 0; /* Vertical padding */
    border-radius: 5px;
    font-family: 'Arial', sans-serif;
    font-size: 18px; /* Font size for the numbers */
    border: 1px solid #218838; /* Darker green border */
    display: block; /* Makes the label take full width of its parent (.rating-buttons-item) */
    width: 45px; /* Fixed width for consistency */
    min-width: 45px; /* Ensures fixed width even if content is smaller */
    text-align: center;
    cursor: pointer;
    transition: background-color 0.2s, border-color 0.2s, transform 0.1s; /* Smooth transitions for hover/check */
  }

  .rating-buttons-item input[type="radio"]:checked + label {
    background-color: #0056b3; /* Primary blue when a button is selected */
    border-color: #004085; /* Darker blue border for selected state */
    transform: scale(1.05); /* Slight enlargement on selection */
  }

  .rating-buttons-item label:hover {
    background-color: #218838; /* Darker green on hover */
    transform: scale(1.02); /* Slight enlargement on hover */
  }

  /* --- "Ruim" and "Excelente" Labels --- */
  .rating-labels-container {
    display: flex; /* Use Flexbox */
    justify-content: space-between; /* Pushes "Ruim" to left and "Excelente" to right */
    width: 100%; /* Spans the full width of its parent */
    padding: 0 4px; /* Matches the padding of individual rating items for alignment */
    box-sizing: border-box;
  }

  .rating-label {
    color: #666666; /* Medium gray for these labels */
    font-family: 'Arial', sans-serif;
    font-size: 13px;
    white-space: nowrap; /* Prevent words from breaking */
  }

  /* --- Observation Textarea --- */
  .form-group {
    margin-bottom: 25px;
  }

  .form-group label { /* Label for "Observação" */
    display: block; /* Make label take its own line */
    font-family: 'Arial', sans-serif;
    font-size: 16px;
    color: #333333;
    margin-bottom: 8px;
    font-weight: bold;
  }

  textarea {
    width: 100%;
    padding: 12px;
    border: 1px solid #cccccc; /* Light gray border */
    border-radius: 5px;
    font-family: 'Arial', sans-serif;
    font-size: 15px;
    box-sizing: border-box;
    resize: vertical; /* Allow vertical resizing only */
    min-height: 100px; /* Minimum height for the textarea */
    max-width: 100%; /* Ensures it doesn't overflow parent */
  }

  textarea:focus {
    outline: none; /* Remove default focus outline */
    border-color: #0056b3; /* Primary blue border on focus */
    box-shadow: 0 0 0 3px rgba(0, 86, 179, 0.2); /* Soft blue glow on focus */
  }

  /* --- Submit Button --- */
  .submit-button {
    text-align: center;
    margin-top: 30px; /* Space above the submit button */
  }

  .submit-button input[type="submit"] {
    background-color: #0056b3; /* Primary blue for submit button */
    color: #ffffff;
    padding: 12px 30px;
    border: none;
    border-radius: 5px;
    font-size: 18px;
    cursor: pointer;
    transition: background-color 0.2s, transform 0.1s;
    font-weight: bold;
  }

  .submit-button input[type="submit"]:hover {
    background-color: #004085; /* Darker blue on hover */
    transform: scale(1.02); /* Slight enlargement on hover */
  }

  .submit-button input[type="submit"]:disabled {
    background-color: #cccccc; /* Gray when disabled */
    cursor: not-allowed;
    opacity: 0.7;
  }

  /* --- Alert Message --- */
  .alert {
    padding: 15px;
    border-radius: 5px;
    font-family: 'Arial', sans-serif;
    font-size: 16px;
    color: #155724; /* Dark green text */
    background-color: #d4edda; /* Light green background */
    border: 1px solid #c3e6cb; /* Green border */
    text-align: center; /* Centers the text content within the alert box */
    /* REMOVIDAS: position: fixed; top: 20px; right: 20px; z-index: 1050; */
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    /* Ajuste de margem se necessário para espaço interno dentro do survey-container */
    margin-top: 0; /* Garante que não há margem extra acima */
    margin-bottom: 0;
  }

  .alert p {
    margin: 0; /* Remove default paragraph margin within alert */
    color: #155724; /* Ensure alert text color is applied */
  }
</style>

<div class="survey-container">
  <% if @survey_submitted %>
    <div class="alert alert-success" role="alert">
      <p>Este chamado já foi avaliado! Obrigado por contribuir para a melhoria de nosso atendimento.</p>
    </div>
  <% else %>
    <h3>Olá <%= @ticket.user_name %>,</h3>
    <p>De acordo com o ticket <%= @ticket.ticket_code %>, como você avalia nosso atendimento?</p>

    <%= form_with model: @survey, url: create_survey_path, method: :post, local: true do |form| %>
      <%= form.hidden_field :ticket_id %>

      <div class="rating-buttons-wrapper">
        <div class="rating-buttons-container">
          <% (1..10).each do |n| %>
            <div class="rating-buttons-item">
              <%= form.radio_button :rate, n, checked: (params[:rate].to_i == n), id: "rate_#{n}" %>
              <%# O atributo `for` na label conecta-o ao radio button pelo ID %>
              <%= form.label :rate, n, for: "rate_#{n}" %>
            </div>
          <% end %>
        </div>
        <div class="rating-labels-container">
          <span class="rating-label">Ruim</span>
          <span class="rating-label">Excelente</span>
        </div>
      </div>

      <div class="form-group">
        <%= form.label :observation, "Observação" %>
        <%= form.text_area :observation, rows: 5, cols: 50 %>
      </div>

      <div class="submit-button">
        <%= form.submit "Enviar", disabled: @survey_submitted %>
      </div>
    <% end %>
  <% end %>
</div>